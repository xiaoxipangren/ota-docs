# 核心概念

完整的OTA系统主要包含工件\(Artifact\)、模块\(Module\)、更新\(Distribution\)、推送\(Rollout\)、终端\(Target\)、终端过滤器\(Filter\)六大对象组成。各对象之间的关系可用下图表示：

![](/assets/ota.jpg)

这几大对象的层次关系可用下图表示：

![](/assets/Selection_016.png)

而一个完成的推送定义流程如下：

![](/assets/Selection_018.png)

## 工件\(Artifact\)

工件是对具体的固件/软件文件的抽象，一个文件\(.zip/.tar.gz/.img\)通过OTA管理系统上传后便成为一个工件，系统会自动计算并存储文件相应的MD5 hash值、文件大小、上传时间等属性。终端设备在升级前应该计算并比对MD5，以防更新文件被篡改。

## 模块\(Module\)

模块是一个具体的固件/软件实体，包含一个承载具体内容的工件，并拥有模块类型、版本、名称等属性，是一个完整更新的一部分。终端设备在更新时应当检测模块的版本是否符合所设定的规则。

## 更新\(Distribution\)

更新是一个系统升级推送的具体内容，可包含多个模块，并具有版本、名称等属性。终端设备在更新时应当检测根性的版本是否符合所设定的规则。

更新和模块之间是多对多的关系，即一个更新可包含多个模块，而一个模块也可被分配给多个更新。

## 设备\(Target\)

设备指在OTA系统中注册的具有名称、安全令牌、IP等属性的IoT终端，是升级的接受者和执行者。设备通过配置的URL地址，向OTA服务器请求升级推送，执行下载更新、实施更新、回报更新状态等操作。

## 终端过滤器\(Filter\)

终端过滤器本质上是一段SQL查询语句，其选定的终端集合可作为一次升级推送的目标。

## 推送\(Rollout\)

推送是由推送内容——更新和更新目标——目标过滤器选定的设备集合组成的抽象概念，一个推送可包含多个独立的目标过滤器，具有创建、挂起、正在执行、成功、失败等状体，并可对其执行启动、暂定、恢复、撤回等操作。

